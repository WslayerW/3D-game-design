### 背包GUI

参考：STARDEW VALLEY

![image-20221207065746272](C:\Users\Lenovo\AppData\Roaming\Typora\typora-user-images\image-20221207065746272.png)

预期制作部分为除装备栏外的不带标签部分



#####原理简述：

主要实现三个函数，分别表示鼠标开始拖动时、拖动中、释放时做的处理。

鼠标开始拖动时要记住拖动前物体的位置，这样当物品被拖到空区域时可以回到初始位置，其次要将canvasGroup.blocksRaycasts设置为false，让event trigger忽略鼠标按着的物体，这样才可以检测到它下面一层的对象,如装备栏或背包栏格子等。

鼠标拖动时主要控制移动到的格子上的背景色变化，当鼠标进入一个格子上时，该格子背景色高亮，鼠标离开时格子背景色恢复成普通。

鼠标释放时根据被拖动物品此刻所在位置决定操作，如果移动到空区域，则物品自动回到初始位置，如果移动到格子上，则物品放到该格子中。

元素的放置有先后顺序，同一位置放置的图层会按照资源顺序从上到下分别为从底层到上层



#####实际结果描述：

预期的结果为上面的三排为背包栏，最下面一排为当前可直接使用的快捷背包栏（本质是背包栏的一种，但是在实际中应当可以通过鼠标滚轮或键盘按键快速选取，此处未实现），第一次从背包向背包移动时会出现bug，在当前image对象不知道为什么锚定不到固定位置的同时，此方格同时会被全局禁用（因为该操作后该位置不再存在可用的image对象），之后背包栏中的移动暂无更多bug;当背包栏直接向快捷栏移动时也会出现锚定错误，实际原因未知（尽力了，对着代码盯了一晚上）





#####可以实现的功能：

（1）同种物品不堆叠（在拖拽的检测部分可以增加种类检测（OnEndDrag处）可堆叠则增加脚标，在取物品时检测当前格子是否还能剩下物品（OnBeginDrag）;实现此功能应当同时实现物品的拆分功能，所以未考虑加以实现）

（2）tab键切换一整栏数据（按理说就是把每一行用一个子panel，然后增加鼠标事件检测，但是由于本来写的跨panel失败了，不知道为什么，所以最后放弃了实现）